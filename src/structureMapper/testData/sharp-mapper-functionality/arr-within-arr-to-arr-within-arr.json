{
  "source": {
    "quoteId": "77",
    "cars": [
      {
        "id": "1",
        "model": "Jaguar",
        "year": 2000,
        "drivers": [
          {
            "id": "d1id1",
            "name": "Test1"
          }, {
            "id": "d1id2",
            "name": "Test2"
          }
        ],
        "locations": [{
          "id": "1"
        }, {
          "id": "2"
        }]
      }, {
        "id": "2",
        "model": "BMW",
        "year": 2012,
        "drivers": [
          {
            "id": "d2id1",
            "name": "Test12"
          }, {
            "id": "d2id2",
            "name": "Test22"
          }
        ],
        "locations": [{
          "id": "3"
        }, {
          "id": "4"
        }]
      }
    ],
  
    "motorcycles": [
      {
        "id": "13",
        "model": "Harvey",
        "year": 2003,
        "drivers": [
          {
            "id": "dtest1",
            "name": "Test1"
          }, {
            "id": "dtest2",
            "name": "Test2"
          }
        ],
        "locations": [{
          "id": "5"
        }, {
          "id": "6"
        }]
      }
    ]
  },

  "schema": [
    {
      "push":{
        "vehicles": {
          "for": {
            "path": ["@cars", "@motorcycles"]
          },
          "push":{
            "details": {
              "id": "$elem.id",
              "model": "$elem.model",
              "year": "$elem.year",
              "objectID": "@quoteId",
              "newValue": 2,
              "drivers": {
                "for": {
                  "path": "$elem.drivers"
                },
                "push":{
                  "id": "$elem.id",
                  "parentID": "$elem.$parent.id"
                }
              },
              "ids":{
                "for": {
                  "path": ["$elem.drivers", "$elem.locations"]
                },
                "push": ["$elem.id"]
              }
            }
          }

        }
      }
    }
  ],

  "output":[{
    "vehicles": [
      {
        "details": {
          "id": "1",
          "model": "Jaguar",
          "year": 2000,
          "objectID": "77",
          "newValue": 2,
          "drivers": [
            {
              "id": "d1id1",
              "parentID": "1"
            }, {
              "id": "d1id2",
              "parentID": "1"
            }
          ],
        "ids": ["d1id1", "d1id2", "1", "2"]
          

        }
      }, {
        "details": {
          "id": "2",
          "model": "BMW",
          "year": 2012,
          "objectID": "77",
          "newValue": 2,
          "drivers": [
            {
              "id": "d2id1",
              "parentID": "2"
            }, {
              "id": "d2id2",
              "parentID": "2"
            }
          ],
          "ids": ["d2id1", "d2id2", "3", "4"]

        }
      }, {
        "details": {
          "id": "13",
          "model": "Harvey",
          "year": 2003,
          "objectID": "77",
          "newValue": 2,
          "drivers": [
            {
              "id": "dtest1",
              "parentID": "13"
            }, {
              "id": "dtest2",
              "parentID": "13"
            }
          ],
          "ids": ["dtest1", "dtest2", "5", "6"]        

        }
      }
    ]
  }]
  

}